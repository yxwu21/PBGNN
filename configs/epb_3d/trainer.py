from src.trainer import EPB3dEnergyTrainerConfig
from src.data import VoxelImage3dEnergyDatasetExtraConfig
from .misc import output_path

epb_model_trainer = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/benchmark_3d_energy_sliding_window/*/*/*/*_raw.pkl.gz",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=10000,
    train_batch_size=64,
    eval_batch_size=16,
    save_and_eval_every=500,
    num_workers=4,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    do_random_crop=True,
    random_crop_atom_num=10,
)

epb_model_psz128_sparse_trainer = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/protein_3d_energy_sparse/*/*/*/*_sparse.pkl.gz",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=6000,
    train_batch_size=64,
    eval_batch_size=16,
    save_and_eval_every=200,
    num_workers=4,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    do_random_crop=True,
    random_crop_atom_num=0.3,
    random_crop_interval=32,
    use_sparse_dataset=True,
)

epb_model_psz128_sparse_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/protein_3d_energy_sparse/*/*/*/*_sparse.pkl.gz",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=4000,
    train_batch_size=32,
    eval_batch_size=16,
    save_and_eval_every=200,
    num_workers=4,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.3,
    random_crop_interval=32,
    use_sparse_dataset=True,
)

epb_model_psz128_sparse_all_in_one_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/new_full_3d_energy_sparse_v2/*/*/*/*_sparse.pkl.gz",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=16,
    save_and_eval_every=400,
    num_workers=4,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.3,
    random_crop_interval=32,
    use_sparse_dataset=True,
)

epb_model_psz128_sparse_all_in_one_fully_coverage_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/new_full_3d_energy_sparse_v2/*/*/*/*_sparse.pkl.gz",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=4,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.1,
    random_crop_interval=32,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
    full_coverage_chunk_size=4,
)

epb_model_psz128_sparse_all_in_one_fully_coverage_rotation_augmented_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/new_full_3d_energy_sparse_v2/*/*/*/*_sparse.pkl.gz",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=8,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.1,
    random_crop_interval=32,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
    full_coverage_chunk_size=4,
    do_random_rotate=True,
    random_rotate_interval=10,
    do_voxel_grids_shrinking=True,
)

epb_model_psz128_sparse_protein_fully_coverage_rotation_augmented_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/new_full_3d_energy_sparse_v2/*/*/*/*_sparse.pkl.gz",
    pkl_filter="protein_test",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=8,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.1,
    random_crop_interval=32,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
    full_coverage_chunk_size=4,
    do_random_rotate=True,
    random_rotate_interval=10,
    do_voxel_grids_shrinking=True,
)

epb_model_psz128_sparse_nucleicacid_fully_coverage_rotation_augmented_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/new_full_3d_energy_sparse_v2/*/*/*/*_sparse.pkl.gz",
    pkl_filter="nucleicacidtest",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=8,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.1,
    random_crop_interval=32,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
    full_coverage_chunk_size=4,
    do_random_rotate=True,
    random_rotate_interval=10,
    do_voxel_grids_shrinking=True,
)

epb_model_psz128_sparse_protein_complex_fully_coverage_rotation_augmented_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/new_full_3d_energy_sparse_v2/*/*/*/*_sparse.pkl.gz",
    pkl_filter="protein_protein_test",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=8,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.1,
    random_crop_interval=32,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
    full_coverage_chunk_size=4,
    do_random_rotate=True,
    random_rotate_interval=10,
    do_voxel_grids_shrinking=True,
)

epb_model_psz64_sparse_protein_complex_fully_coverage_rotation_augmented_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/new_full_3d_energy_sparse_v2/*/*/*/*_sparse.pkl.gz",
    pkl_filter="protein_protein_test",
    patch_size=64,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=8,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.1,
    random_crop_interval=32,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
    full_coverage_chunk_size=4,
    do_random_rotate=True,
    random_rotate_interval=10,
    do_voxel_grids_shrinking=True,
)

epb_model_psz64_sparse_small_mol_fully_coverage_rotation_augmented_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/small_mol_full_3d_energy_sparse/*/*/*/*_sparse.pkl.gz",
    patch_size=64,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=8000,
    train_batch_size=128,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=8,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=1,
    do_random_crop=True,
    random_crop_atom_num=0.1,
    random_crop_interval=32,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
    full_coverage_chunk_size=4,
    do_random_rotate=True,
    random_rotate_interval=10,
    do_voxel_grids_shrinking=False,
)

epb_model_psz128_sparse_all_in_one_grid035_fully_coverage_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/new_full_3d_energy_sparse_v2/*/*/*/*_sparse.pkl.gz",
    pkl_filter="bench_full_abs_cpu_035",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=4,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.1,
    random_crop_interval=32,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
    full_coverage_chunk_size=4,
)

epb_model_psz128_sparse_all_in_one_eval_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/new_full_3d_energy_sparse_v2/*/*/*/*_sparse.pkl.gz",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=4,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.3,
    random_crop_interval=32,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
)

epb_model_psz128_sparse_all_in_one_rotate90_eval_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/new_full_3d_energy_sparse_v2/*/*/*/*_sparse.pkl.gz",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=4,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.3,
    random_crop_interval=32,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
    do_fixed_rotate_in_eval=True,
    rotate_k=1,
    rotate_axis=[0, 1],
)

epb_model_psz128_sparse_all_in_one_rotate_any_eval_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/new_full_3d_energy_sparse_v2/*/*/*/*_sparse.pkl.gz",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=4,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.3,
    random_crop_interval=32,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
    do_random_rotate_in_eval=True,
    given_rotate_angle=[30],
    given_rotate_axis=["z"],
    do_voxel_grids_shrinking=True,
)

epb_model_psz128_sparse_small_mol_rotate_any_eval_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/small_mol_full_3d_energy_sparse/*/*/*/*_sparse.pkl.gz",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=4,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.3,
    random_crop_interval=32,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
    do_random_rotate_in_eval=True,
    given_rotate_angle=[30],
    given_rotate_axis=["z"],
    do_voxel_grids_shrinking=True,
)

epb_model_psz64_sparse_trainer = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/protein_3d_energy_sparse/*/*/*/*_sparse.pkl.gz",
    patch_size=64,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=4000,
    train_batch_size=256,
    eval_batch_size=16,
    save_and_eval_every=200,
    num_workers=4,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    do_random_crop=True,
    random_crop_atom_num=200,
    use_sparse_dataset=True,
)

epb_model_psz64_sparse_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/protein_3d_energy_sparse/*/*/*/*_sparse.pkl.gz",
    patch_size=64,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=4000,
    train_batch_size=128,
    eval_batch_size=16,
    save_and_eval_every=200,
    num_workers=4,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    do_random_crop=True,
    random_crop_atom_num=0.3,
    random_crop_interval=32,
    use_sparse_dataset=True,
)

epb_model_psz64_sparse_debug_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/protein_3d_energy_sparse/*/*/*/*_sparse.pkl.gz",
    patch_size=64,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=4000,
    train_batch_size=128,
    eval_batch_size=16,
    save_and_eval_every=200,
    num_workers=0,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    do_random_crop=True,
    random_crop_atom_num=0.3,
    random_crop_interval=32,
    use_sparse_dataset=True,
)

epb_model_wo_random_crop_trainer = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/benchmark_3d_energy_sliding_window/*/*/*/*_raw.pkl.gz",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=10000,
    train_batch_size=64,
    eval_batch_size=16,
    save_and_eval_every=100,
    num_workers=4,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    do_random_crop=False,
)

epb_model_debug_trainer = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/benchmark_3d_energy_sliding_window/*/*/*/*_raw.pkl.gz",
    patch_size=128,
    output_folder=output_path,
    train_lr=5e-4,
    train_num_steps=50,
    train_batch_size=64,
    eval_batch_size=16,
    save_and_eval_every=10,
    num_workers=4,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    do_random_crop=True,
    random_crop_atom_num=10,
)

epb_model_psz64_ctx32_sparse_protein_complex_fully_coverage_rotation_augmented_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/new_full_3d_energy_sparse_v2/*/*/*/*_sparse.pkl.gz",
    pkl_filter="protein_protein_test",
    patch_size=64,
    output_folder=output_path,
    train_lr=5e-4,
    final_train_lr=1e-6,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=8,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.1,
    random_crop_interval=32,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
    full_coverage_chunk_size=4,
    do_random_rotate=True,
    random_rotate_interval=10,
    do_voxel_grids_shrinking=False,
    train_dataset_extra_config=VoxelImage3dEnergyDatasetExtraConfig(context_size=32),
    eval_dataset_extra_config=VoxelImage3dEnergyDatasetExtraConfig(context_size=32),
)

epb_model_psz64_ctx32_sparse_all_in_one_fully_coverage_rotation_augmented_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/new_full_3d_energy_sparse_v2/*/*/*/*_sparse.pkl.gz",
    patch_size=64,
    output_folder=output_path,
    train_lr=5e-4,
    final_train_lr=1e-6,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=8,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.1,
    random_crop_interval=32,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
    full_coverage_chunk_size=4,
    do_random_rotate=True,
    random_rotate_interval=10,
    do_voxel_grids_shrinking=False,
    train_dataset_extra_config=VoxelImage3dEnergyDatasetExtraConfig(context_size=32),
    eval_dataset_extra_config=VoxelImage3dEnergyDatasetExtraConfig(context_size=32),
)

epb_model_psz32_ctx48_sparse_protein_complex_fully_coverage_rotation_augmented_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/new_full_3d_energy_sparse_v2/*/*/*/*_sparse.pkl.gz",
    pkl_filter="protein_protein_test",
    patch_size=32,
    output_folder=output_path,
    train_lr=5e-4,
    final_train_lr=1e-6,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=8,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.05,
    random_crop_interval=8,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
    full_coverage_chunk_size=4,
    do_random_rotate=True,
    random_rotate_interval=10,
    do_voxel_grids_shrinking=False,
    train_dataset_extra_config=VoxelImage3dEnergyDatasetExtraConfig(context_size=48),
    eval_dataset_extra_config=VoxelImage3dEnergyDatasetExtraConfig(context_size=48),
)

epb_model_psz16_ctx56_sparse_protein_complex_fully_coverage_rotation_augmented_trainer_medium = EPB3dEnergyTrainerConfig(
    dataset_path="datasets/processed/new_full_3d_energy_sparse_v2/*/*/*/*_sparse.pkl.gz",
    pkl_filter="protein_protein_test",
    patch_size=16,
    output_folder=output_path,
    train_lr=5e-4,
    final_train_lr=1e-6,
    train_num_steps=8000,
    train_batch_size=32,
    eval_batch_size=4,
    save_and_eval_every=400,
    num_workers=8,
    probe_radius_upperbound=1.5,
    probe_radius_lowerbound=-5,
    do_bf16_training=True,
    gradient_accumulation_steps=2,
    do_random_crop=True,
    random_crop_atom_num=0.01,
    random_crop_interval=8,
    use_sparse_dataset=True,
    use_full_coverage_sparse_dataset=True,
    full_coverage_chunk_size=4,
    do_random_rotate=True,
    random_rotate_interval=10,
    do_voxel_grids_shrinking=False,
    train_dataset_extra_config=VoxelImage3dEnergyDatasetExtraConfig(context_size=56),
    eval_dataset_extra_config=VoxelImage3dEnergyDatasetExtraConfig(context_size=56),
)
